<div class="shelf-group">
  <div class="shelf">
    <div class="shelf-label" ng-click="togglePropsExpand()">{{ encType }}</div>
    <!--<field-drop field-def="enc[encType]" types="schema.properties.type.enum"></field-drop>-->
    <div class="field-drop"
         ng-model="pills[encType]"
         data-drop="true"
         jqyoui-droppable="{onDrop:'fieldDropped'}"
         data-jqyoui-options="{activeClass: 'drop-active'}">
      <div class="field-pill"
           ng-if="enc[encType].name"
           ng-click="toggleFuncsExpand()"
           data-drag="true"
           ng-model="pills[encType]"
           jqyoui-draggable="{onStart: 'fieldDragStart'}"
           data-jqyoui-options="{revert: 'invalid', helper: 'clone'}"
        >
        <field-info field="enc[encType]"></field-info>
        <a href="#" class="remove-field" ng-click="removeField()">Ã—</a>
      </div>

      <span class="placeholder" ng-if="!enc[encType].name">drop a field here</span>
  </div>
  </div>

  <div class="shelf-properties" ng-show="propsExpanded">
    <div>
      <property-editor ng-show="schema.properties.legend" id="encType + 'legend'" type="schema.properties.legend.type" enum="schema.properties.legend.enum" prop-name="'legend'" group="enc[encType]"></property-editor>
    </div>
    <div>
      <property-editor ng-show="schema.properties.value" id="encType + 'value'" type="schema.properties.value.type" enum="schema.properties.value.enum" prop-name="'value'" group="enc[encType]"></property-editor>
    </div>

    <div ng-repeat="group in ['scale', 'text', 'axis']"
         ng-show="schema.properties[group]">
      <h4>{{ group }}</h4>
      <div ng-repeat="(propName, scaleProp) in schema.properties[group].properties"
           ng-init="id = encType + group + $index"
           ng-show="scaleProp.supportedTypes ? scaleProp.supportedTypes[enc[encType].type] : true">
        <property-editor id="id" type="scaleProp.type" enum="scaleProp.enum" prop-name="propName" group="enc[encType][group]"></property-editor>
      </div>
    </div>
  </div>
  <div class="shelf-functions" ng-show="funcsExpanded && enc[encType].name">
    <div class="mb5">
      <h4>Types</h4>
      <span ng-if="allowedTypes.length<=1">
        {{typeNames[enc[encType].type]}}
      </span>
      <label class="type-label"
        ng-if="allowedTypes.length>1"
        ng-repeat="type in allowedTypes">
        <input type="radio" ng-value="type" ng-model="enc[encType].type">
        {{typeNames[type]}}
      </label>
      <!-- <select class="type-select" ng-model="enc[encType].type"
              ng-options="type as typeNames[type] for type in schema.properties.type.enum track by type">
      </select> -->
    </div>

    <function-select pills="pills" enc-type="encType" schema="schema"></function-select>


  </div>
</div>
